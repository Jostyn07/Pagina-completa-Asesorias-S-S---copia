<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Cliente - S&S Asesor铆as</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="../css/sidebar.css">
    <link rel="stylesheet" href="../css/cliente.css">
</head>
<body>
    <!-- SIDEBAR UNIFICADO -->
    <aside class="sidebar-unified" id="sidebar">
        <div class="sidebar-header">
            <a href="./home.html" class="sidebar-logo-link">
                <img src="../images/Logo.png" alt="S&S Asesor铆as" class="sidebar-logo-img">
            </a>
            <button class="sidebar-toggle-btn" onclick="toggleSidebar()">
                <span class="material-symbols-rounded">chevron_left</span>
            </button>
        </div>

        <div class="sidebar-search">
            <div class="search-box">
                <span class="material-symbols-rounded">search</span>
                <input type="text" placeholder="Buscar...">
            </div>
        </div>

        <nav class="sidebar-nav">
            <a href="./home.html" class="menu-item">
                <span class="material-symbols-rounded">home</span>
                <span>Inicio</span>
            </a>

            <a href="./polizas.html" class="menu-item active">
                <span class="material-symbols-rounded">description</span>
                <span>P贸lizas</span>
            </a>

            <a href="#" class="menu-item">
                <span class="material-symbols-rounded">bar_chart</span>
                <span>Gr谩ficos</span>
            </a>

            <a href="#" class="menu-item">
                <span class="material-symbols-rounded">folder</span>
                <span>Gestiones</span>
            </a>

            <a href="#" class="menu-item">
                <span class="material-symbols-rounded">trending_up</span>
                <span>Seguimiento</span>
            </a>

            <a href="#" class="menu-item">
                <span class="material-symbols-rounded">rate_review</span>
                <span>Solicitud de revisi贸n mercado</span>
            </a>

            <a href="./para-revisar.html" class="menu-item">
                <span class="material-symbols-rounded">fact_check</span>
                <span>Para revisar</span>
            </a>

            <a href="./control_calidad.html" class="menu-item">
                <span class="material-symbols-rounded">verified</span>
                <span>Control de calidad</span>
            </a>

            <a href="./historial_evaluacion.html" class="menu-item">
                <span class="material-symbols-rounded">history</span>
                <span>Mis Evaluaciones</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="dark-mode-toggle" onclick="toggleDarkMode()">
                <div class="dark-mode-label">
                    <span class="material-symbols-rounded">dark_mode</span>
                    <span>Modo Oscuro</span>
                </div>
                <div class="toggle-switch" id="darkModeSwitch">
                    <div class="toggle-circle"></div>
                </div>
            </div>
        </div>
    </aside>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="main-container">
        <!-- HEADER -->
        < class="page-header">
            <div class="header-left">
                <button class="btn-back" onclick="window.location.href='./polizas.html'">
                    <span class="material-symbols-rounded">arrow_back</span>
                    Volver a P贸lizas
                </button>
                <h1 id="pageTitle">锔 Editar Cliente y P贸liza</h1>
            </div>
            <div class="header-right">
                <div class="autosave-indicator" id="autosaveIndicator">
                    <span class="material-symbols-rounded">cloud_done</span>
                    <span id="autosaveText">Todos los cambios guardados</span>
                </div>
            </div>
                <div class="user-menu">
                    <button class="user-profile-btn" onclick="toggleUserMenu()">
                        <img src="https://ui-avatars.com/api/?name=Usuario&background=667eea&color=fff&size=40" 
                             alt="Usuario" 
                             class="user-avatar">
                        <span class="material-symbols-rounded dropdown-icon">expand_more</span>
                    </button>
                    
                    <div class="user-dropdown" id="userDropdown">
                        <div class="user-dropdown-header">
                            <div class="user-info">
                                <strong id="userName">Usuario</strong>
                                <small id="userEmail">usuario@ejemplo.com</small>
                            </div>
                        </div>
                        <div class="user-dropdown-divider"></div>
                        <button class="dropdown-item">
                            <span class="material-symbols-rounded">person</span>
                            Mi Perfil
                        </button>
                        <button class="dropdown-item">
                            <span class="material-symbols-rounded">settings</span>
                            Configuraci贸n
                        </button>
                        <div class="user-dropdown-divider"></div>
                        <button class="dropdown-item danger" onclick="cerrarSesion()">
                            <span class="material-symbols-rounded">logout</span>
                            Cerrar Sesi贸n
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- TABS NAVEGACIN -->
        <div class="tabs-container">
            <div class="tabs-nav" id="tabsNav">
                <button class="tab-btn active" data-tab="info-general">
                    <span class="material-symbols-rounded">person</span>
                    Informaci贸n General
                </button>
                <button class="tab-btn" data-tab="dependientes">
                    <span class="material-symbols-rounded">family_restroom</span>
                    Dependientes
                </button>
                <button class="tab-btn tab-estado" data-tab="estado" style="display: none;">
                    <span class="material-symbols-rounded">verified</span>
                    Estado y Seguimiento
                </button>
                <button class="tab-btn" data-tab="pago">
                    <span class="material-symbols-rounded">payment</span>
                    M茅todo de Pago
                </button>
                <button class="tab-btn tab-comisiones" data-tab="comisiones" style="display: none;">
                    <span class="material-symbols-rounded">payments</span>
                     Comisiones
                </button>
                <button class="tab-btn" data-tab="documentos">
                    <span class="material-symbols-rounded">attach_file</span>
                    Documentos
                </button>
                <button class="tab-btn" data-tab="notas">
                    <span class="material-symbols-rounded">chat</span>
                     Notas
                </button>
            </div>
        </div>

        <!-- FORMULARIO -->
        <form id="clienteForm" class="cliente-form">
            
            <!-- TAB 1: INFORMACIN GENERAL -->
            <div class="tab-content active" id="tab-info-general">
                
                <!-- DATOS PERSONALES -->
                <div class="form-section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-title">
                            <span class="material-symbols-rounded">person</span>
                            <h2>Datos Personales</h2>
                        </div>
                        <span class="material-symbols-rounded toggle-icon">expand_less</span>
                    </div>
                    <div class="section-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Tipo de registro <span class="required">*</span></label>
                                <select id="tipoRegistro" name="tipoRegistro" required>
                                    <option value="">Selecciona...</option>
                                    <option value="Nuevo">Nuevo</option>
                                    <option value="Renovacion">Renovaci贸n</option>
                                    <option value="Cambio">Cambio de plan</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Fecha de registro</label>
                                <input type="text" id="fechaRegistro" name="fechaRegistro" readonly value="">
                                <span class="input-icon"></span>
                                <small class="helper-text">Generada autom谩ticamente</small>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Nombres <span class="required">*</span></label>
                                <input type="text" id="nombres" name="nombres" placeholder="Nombres del titular" required>
                                <span class="validation-message"></span>
                            </div>
                            <div class="form-group">
                                <label>Apellidos <span class="required">*</span></label>
                                <input type="text" id="apellidos" name="apellidos" placeholder="Apellidos del titular" required>
                                <span class="validation-message"></span>
                            </div>
                            <div class="form-group">
                                <label>Genero <span class="required">*</span></label>
                                <select id="genero" name="genero" required>
                                    <option value="">Selecciona...</option>
                                    <option value="masculino">Masculino</option>
                                    <option value="femenino">Femenino</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Correo electr贸nico <span class="required">*</span></label>
                                <input type="email" id="email" name="email" placeholder="correo@ejemplo.com" required>
                                <span class="validation-message"></span>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Tel茅fono 1 <span class="required">*</span></label>
                                <input type="tel" id="telefono1" name="telefono1" placeholder="(305) 123-4567" required>
                                <span class="validation-message"></span>
                            </div>
                            <div class="form-group">
                                <label>Tel茅fono 2</label>
                                <input type="tel" id="telefono2" name="telefono2" placeholder="(305) 123-4567">
                            </div>
                            <div class="form-group">
                                <label>Fecha de nacimiento <span class="required">*</span></label>
                                <input type="date" id="fechaNacimiento" name="fechaNacimiento" required>
                                <span class="validation-message"></span>
                            </div>
                            <div class="form-group">
                                <label>Estado migratorio <span class="required">*</span></label>
                                <select id="estadoMigratorio" name="estadoMigratorio" required>
                                    <option value="">Selecciona...</option>
                                    <option value="ciudadano">Ciudadano</option>
                                    <option value="Residente Permanente">Residente Permanente</option>
                                    <option value="Permiso de trabajo">Permiso de trabajo</option>
                                    <option value="Asilo politico">Asilo politico</option>
                                    <option value="I-94">I-94</option>
                                    <option value="Otro">Otro</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>SSN</label>
                                <input type="text" id="ssn" name="ssn" placeholder="XXX-XX-XXXX" maxlength="11">
                                <span class="validation-message"></span>
                            </div>
                            <div class="form-group">
                                <label>Ingresos anuales</label>
                                <input type="number" id="ingresos" name="ingresos" placeholder="0" value="0" min="0">
                            </div>
                            <div class="form-group">
                                <label>Ocupaci贸n</label>
                                <input type="text" id="ocupacion" name="ocupacion" placeholder="Ocupaci贸n del titular">
                            </div>
                            <div class="form-group">
                                <label>Nacionalidad <span class="required">*</span></label>
                                <input type="text" id="nacionalidad" name="nacionalidad" placeholder="Ej: Estadounidense" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>驴Aplica para el seguro? <span class="required">*</span></label>
                                <select id="aplica" name="aplica" required>
                                    <option value="">Selecciona...</option>
                                    <option value="S铆">S铆</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- DIRECCIN -->
                <div class="form-section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-title">
                            <span class="material-symbols-rounded">home</span>
                            <h2>Direcci贸n</h2>
                        </div>
                        <span class="material-symbols-rounded toggle-icon">expand_less</span>
                    </div>
                    <div class="section-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Direcci贸n <span class="required">*</span></label>
                                <input type="text" id="direccion" name="direccion" placeholder="Direcci贸n del titular" required>
                            </div>
                            <div class="form-group">
                                <label>Casa/Apartamento</label>
                                <input type="text" id="casaApartamento" name="casaApartamento" placeholder="Ej: Apt 4B">
                            </div>
                            <div class="form-group">
                                <label>Condado <span class="required">*</span></label>
                                <input type="text" id="condado" name="condado" placeholder="Condado del titular" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Ciudad <span class="required">*</span></label>
                                <input type="text" id="ciudad" name="ciudad" placeholder="Ciudad del titular" required>
                            </div>
                            <div class="form-group">
                                <label>Estado <span class="required">*</span></label>
                                <select id="estado" name="estado" required>
                                    <option value="">Selecciona...</option>
                                    <option value="AL">Alabama (AL)</option>
                                    <option value="AZ">Arizona (AZ)</option>
                                    <option value="FL">Florida (FL)</option>
                                    <option value="GA">Georgia (GA)</option>
                                    <option value="IL">Illinois (IL)</option>
                                    <option value="IN">Indiana (IN)</option>
                                    <option value="KS">Kansas (KS)</option>
                                    <option value="LA">Louisiana (LA)</option>
                                    <option value="MI">Michigan (MI)</option>
                                    <option value="MO">Missouri (MO)</option>
                                    <option value="MS">Mississippi (MS)</option>
                                    <option value="MS">Maryland (MD)</option>
                                    <option value="NC">North Carolina (NC)</option>
                                    <option value="NJ">New Jersey (NJ)</option>
                                    <option value="OH">Ohio (OH)</option>
                                    <option value="OK">Oklahoma (OK)</option>
                                    <option value="OK">Pensilvania (PA)</option>
                                    <option value="SC">Carolina del Sur (SC)</option>
                                    <option value="TN">Tennessee (TN)</option>
                                    <option value="TX">Texas (TX)</option>
                                    <option value="UT">Utah (UT)</option>
                                    <option value="VA">Virginia (VA)</option>
                                    <!-- Agregar m谩s estados seg煤n necesidad -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label>C贸digo Postal <span class="required">*</span></label>
                                <input type="text" id="codigoPostal" name="codigoPostal" placeholder="33101" maxlength="5" required>
                                <span class="validation-message"></span>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group checkbox-group">
                                <label>
                                    <input type="checkbox" id="tienePOBox" name="tienePOBox" onchange="togglePOBox()">
                                    驴Tiene PO Box?
                                </label>
                            </div>
                            <div class="form-group" id="poBoxGroup" style="display: none;">
                                <label>PO Box</label>
                                <input type="text" id="poBox" name="poBox" placeholder="PO Box 12345">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- INFORMACIN DE LA PLIZA -->
                <div class="form-section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-title">
                            <span class="material-symbols-rounded">description</span>
                            <h2>Informaci贸n de la P贸liza</h2>
                        </div>
                        <span class="material-symbols-rounded toggle-icon">expand_less</span>
                    </div>
                    <div class="section-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Compa帽铆a Aseguradora <span class="required">*</span></label>
                                <select id="compania" name="compania" required>
                                    <option value="">Selecciona...</option>
                                    <option value="Aetna">Aetna</option>
                                    <option value="Ambetter">Ambetter</option>
                                    <option value="Ameri HealthCaritas Next">Ameri HealthCaritas Next</option>
                                    <option value="Antidothe">Antidothe</option>
                                    <option value="Athem">Athem</option>
                                    <option value="Baylor">Baylor</option>
                                    <option value="Blue Cross and Blue Shield">Blue Cross and Blue Shield</option>
                                    <option value="CareSource">CareSource</option>
                                    <option value="Christus Health Plan">Christus Health Plan</option>
                                    <option value="Cigna">Cigna</option>
                                    <option value="Community Health Choice">Community Health Choice</option>
                                    <option value="Florida Blue">Florida Blue</option>
                                    <option value="Harbor">Harbor</option>
                                    <option value="Health Firts">Health Firts</option>
                                    <option value="Imperial Insurance">Imperial Insurance</option>
                                    <option value="Molina">Molina</option>
                                    <option value="Oscar">Oscar</option>
                                    <option value="United HealthCare">United HealthCare</option>
                                    <option value="WellPoint">WellPoint</option>
                                </select>
                            </div>
                            <div class="form-row">
                            <div class="form-group">
                                    <label>N煤mero de P贸liza</label>
                                    <div class="readonly-field">
                                        <span id="numeroPolizaDisplay">Se generar谩 autom谩ticamente</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Plan <span class="required">*</span></label>
                                <input type="text" id="plan" name="plan" placeholder="Ej: Bronze 2219" required>
                            </div>
                            <div class="form-group">
                                <label>Prima <span class="required">*</span></label>
                                <input type="number" id="prima" name="prima" placeholder="0.00" step="0.01" min="0" required>
                                <span class="validation-message"></span>
                            </div>
                            <div class="form-group">
                                <label>Cr茅dito Fiscal</label>
                                <input type="number" id="creditoFiscal" name="creditoFiscal" placeholder="0.00" step="0.01" min="0" value="0">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Tipo de venta <span class="required">*</span></label>
                                <select id="tipoVenta" name="tipoVenta" required>
                                    <option value="">Selecciona...</option>
                                    <option value="Nueva">Nueva venta</option>
                                    <option value="Renovacion">Renovaci贸n</option>
                                    <option value="Cambio">Cambio de plan</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Operador <span class="required">*</span></label>
                                <select id="operadorNombre" name="operadorNombre" required>
                                    <option value="">Selecciona...</option>
                                    <option value="Jostyn Arag贸n">Jostyn Arag贸n</option>
                                    <option value="Ana Pedroza">Ana Pedroza</option>
                                    <option value="Edgar Sanchez">Edgar Sanchez</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group full-width">
                                <label>Enlace de la P贸liza</label>
                                <input type="url" id="enlacePoliza" name="enlacePoliza" placeholder="https://portal.compania.com/...">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Member ID</label>
                                <input type="text" id="memberId" name="memberId" placeholder="ID del miembro">
                            </div>
                            <div class="form-group">
                                <label>Agente</label>
                                <input type="text" id="agenteNombre" name="agenteNombre" placeholder="Ej: Joel Nieves - 19952518">
                            </div>
                            <div class="form-group">
                                <label>Clave de Seguridad</label>
                                <input type="text" id="claveSeguridad" name="claveSeguridad" placeholder="Ej: Azul">
                            </div>
                        </div>

                        <!-- FECHAS AUTOMTICAS -->
                        <div class="form-row">
                            <div class="form-group full-width">
                                <div class="info-box">
                                    <div class="info-box-header">
                                        <span class="material-symbols-rounded">calendar_today</span>
                                        <h3>Fechas de Cobertura (Calculadas autom谩ticamente)</h3>
                                        <span class="lock-icon"></span>
                                    </div>
                                    <div class="info-box-content">
                                        <div class="date-display">
                                            <label>Fecha inicial cobertura:</label>
                                            <span id="displayFechaInicial">--/--/----</span>
                                        </div>
                                        <div class="date-display">
                                            <label>Fecha final cobertura:</label>
                                            <span id="displayFechaFinal">--/--/----</span>
                                        </div>
                                        <div class="date-display">
                                            <label>Fecha efectividad:</label>
                                            <span id="displayFechaEfectividad">--/--/----</span>
                                        </div>
                                        <small class="helper-text">
                                            <span class="material-symbols-rounded">info</span>
                                            Estas fechas se calculan autom谩ticamente para el pr贸ximo mes
                                        </small>
                                    </div>
                                    <!-- Hidden inputs para enviar en el form -->
                                    <input type="hidden" id="fechaInicialCobertura" name="fechaInicialCobertura">
                                    <input type="hidden" id="fechaFinalCobertura" name="fechaFinalCobertura">
                                    <input type="hidden" id="fechaEfectividad" name="fechaEfectividad">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 2: DEPENDIENTES -->
            <div class="tab-content" id="tab-dependientes">
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-title">
                            <span class="material-symbols-rounded">family_restroom</span>
                            <h2>Dependientes</h2>
                            <span class="counter" id="dependientesCounter">(0)</span>
                        </div>
                        <button type="button" class="btn-add" onclick="agregarDependiente()">
                            <span class="material-symbols-rounded">add</span>
                            Agregar Dependiente
                        </button>
                    </div>
                    <div class="section-content">
                        <div id="dependientesContainer">
                            <div class="empty-state">
                                <span class="material-symbols-rounded">family_restroom</span>
                                <p>No hay dependientes agregados</p>
                                <small>Haz clic en "Agregar Dependiente" para comenzar</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 3: ESTADO Y SEGUIMIENTO (Solo visible en modo EDITAR) -->
            <div class="tab-content" id="tab-estado">
                <div class="info-message">
                    <span class="material-symbols-rounded">info</span>
                    <p>Los estados de Compa帽铆a y Mercado estar谩n disponibles despu茅s de guardar la p贸liza.</p>
                </div>

                <!-- ESTADO EN COMPAA -->
                <div class="form-section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-title">
                            <span class="material-symbols-rounded">business</span>
                            <h2>Estado en Compa帽铆a</h2>
                        </div>
                        <span class="material-symbols-rounded toggle-icon">expand_less</span>
                    </div>
                    <div class="section-content">
                        <!-- Contenido se habilitar谩 en modo editar -->
                        <p class="text-muted">Disponible despu茅s de procesar la p贸liza</p>
                    </div>
                </div>

                <!-- ESTADO EN MERCADO -->
                <div class="form-section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-title">
                            <span class="material-symbols-rounded">public</span>
                            <h2>Estado en Mercado</h2>
                        </div>
                        <span class="material-symbols-rounded toggle-icon">expand_less</span>
                    </div>
                    <div class="section-content">
                        <!-- Contenido se habilitar谩 en modo editar -->
                        <p class="text-muted">Disponible despu茅s de procesar la p贸liza</p>
                    </div>
                </div>
            </div>

            <!-- TAB 4: MTODO DE PAGO -->
            <div class="tab-content" id="tab-pago">
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-title">
                            <span class="material-symbols-rounded">payment</span>
                            <h2>M茅todo de Pago</h2>
                        </div>
                        <button type="button" class="btn-secondary" onclick="limpiarMetodoPago()">
                            <span class="material-symbols-rounded">delete</span>
                            Limpiar
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="payment-methods">
                            <div class="payment-option">
                                <label class="radio-label">
                                    <input type="radio" name="metodoPago" value="banco" onchange="mostrarFormularioPago('banco')">
                                    <span class="radio-custom"></span>
                                    <span class="radio-text">
                                        <span class="material-symbols-rounded">account_balance</span>
                                        Cuenta de banco
                                    </span>
                                </label>
                                
                                <div id="formBanco" class="payment-form" style="display: none;">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Nombre del banco</label>
                                            <input type="text" id="nombreBanco" name="nombreBanco" placeholder="Bank of America">
                                        </div>
                                        <div class="form-group">
                                            <label>N煤mero de cuenta</label>
                                            <input type="text" id="numeroCuenta" name="numeroCuenta" placeholder="****1234">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Routing number</label>
                                            <input type="text" id="routingNumber" name="routingNumber" placeholder="021000021">
                                        </div>
                                        <div class="form-group">
                                            <label>Nombre en la cuenta</label>
                                            <input type="text" id="nombreCuenta" name="nombreCuenta" placeholder="Juan P茅rez">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="payment-option">
                                <label class="radio-label">
                                    <input type="radio" name="metodoPago" value="tarjeta" onchange="mostrarFormularioPago('tarjeta')">
                                    <span class="radio-custom"></span>
                                    <span class="radio-text">
                                        <span class="material-symbols-rounded">credit_card</span>
                                        Tarjeta de cr茅dito/d茅bito
                                    </span>
                                </label>
                                
                                <div id="formTarjeta" class="payment-form" style="display: none;">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>N煤mero de tarjeta</label>
                                            <input type="text" id="numeroTarjeta" name="numeroTarjeta" placeholder="**** **** **** 1234" maxlength="19">
                                        </div>
                                        <div class="form-group">
                                            <label>Nombre en la tarjeta</label>
                                            <input type="text" id="nombreTarjeta" name="nombreTarjeta" placeholder="Juan P茅rez">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Fecha de expiraci贸n</label>
                                            <input type="text" id="fechaExpiracion" name="fechaExpiracion" placeholder="MM/YY" maxlength="5">
                                        </div>
                                        <div class="form-group">
                                            <label>CVV</label>
                                            <input type="text" id="cvv" name="cvv" placeholder="123" maxlength="4">
                                        </div>
                                        <div class="form-group">
                                            <label>Tipo de tarjeta</label>
                                            <select id="tipoTarjeta" name="tipoTarjeta">
                                                <option value="">Selecciona...</option>
                                                <option value="visa">Visa</option>
                                                <option value="mastercard">Mastercard</option>
                                                <option value="amex">American Express</option>
                                                <option value="discover">Discover</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row mt-3">
                            <div class="form-group checkbox-group">
                                <label>
                                    <input type="checkbox" id="usarMismaDireccion" name="usarMismaDireccion" checked>
                                    Usar la misma direcci贸n del cliente
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 5: COMISIONES (Solo Admin) -->
            <div class="tab-content" id="tab-comisiones">
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-title">
                            <span class="material-symbols-rounded">payments</span>
                            <h2>Comisiones Mensuales</h2>
                            <span class="badge-admin">Solo Admin</span>
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="comisiones-grid">
                            <div class="form-group">
                                <label>Enero</label>
                                <input type="number" id="comisionEnero" name="comisionEnero" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Febrero</label>
                                <input type="number" id="comisionFebrero" name="comisionFebrero" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Marzo</label>
                                <input type="number" id="comisionMarzo" name="comisionMarzo" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Abril</label>
                                <input type="number" id="comisionAbril" name="comisionAbril" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Mayo</label>
                                <input type="number" id="comisionMayo" name="comisionMayo" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Junio</label>
                                <input type="number" id="comisionJunio" name="comisionJunio" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Julio</label>
                                <input type="number" id="comisionJulio" name="comisionJulio" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Agosto</label>
                                <input type="number" id="comisionAgosto" name="comisionAgosto" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Septiembre</label>
                                <input type="number" id="comisionSeptiembre" name="comisionSeptiembre" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Octubre</label>
                                <input type="number" id="comisionOctubre" name="comisionOctubre" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Noviembre</label>
                                <input type="number" id="comisionNoviembre" name="comisionNoviembre" placeholder="0.00" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label>Diciembre</label>
                                <input type="number" id="comisionDiciembre" name="comisionDiciembre" placeholder="0.00" step="0.01" value="0">
                            </div>
                        </div>

                        <div class="comisiones-summary">
                            <div class="summary-item">
                                <span>Total anual:</span>
                                <strong id="totalAnual">$0.00</strong>
                            </div>
                            <div class="summary-item">
                                <span>Promedio mensual:</span>
                                <strong id="promedioMensual">$0.00</strong>
                            </div>
                            <div class="summary-item">
                                <span>Meses con comisi贸n:</span>
                                <strong id="mesesConComision">0/12</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 6: DOCUMENTOS -->
            <div class="tab-content" id="tab-documentos">
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-title">
                            <span class="material-symbols-rounded">attach_file</span>
                            <h2>Documentos y Archivos</h2>
                            <span class="counter" id="documentosCounter">(0)</span>
                        </div>
                        <button type="button" class="btn-add" onclick="agregarDocumento()">
                            <span class="material-symbols-rounded">add</span>
                            Agregar Archivo
                        </button>
                    </div>
                    <div class="section-content">
                        <div id="documentosContainer">
                            <div class="empty-state">
                                <span class="material-symbols-rounded">upload_file</span>
                                <p>No hay documentos cargados</p>
                                <small>Haz clic en "Agregar Archivo" para comenzar</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 7: NOTAS -->
            <div class="tab-content" id="tab-notas">
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-title">
                            <span class="material-symbols-rounded">chat</span>
                            <h2>Notas y Comunicaci贸n</h2>
                            <span class="counter" id="notasCounter">(0)</span>
                        </div>
                    </div>
                    <div class="section-content">
                        <!-- Thread de notas -->
                        <div class="notas-thread" id="notasThread">
                            <div class="empty-state">
                                <span class="material-symbols-rounded">chat_bubble</span>
                                <p>No hay notas a煤n</p>
                                <small>Escribe la primera nota para este cliente</small>
                            </div>
                        </div>

                        <!-- Formulario nueva nota -->
                        <div class="nueva-nota">
                            <h3>Nueva Nota</h3>
                            <textarea id="nuevaNota" placeholder="Escribe tu mensaje aqu铆..." rows="4"></textarea>
                            
                            <div class="nota-attachments">
                                <label class="btn-attach">
                                    <span class="material-symbols-rounded">attach_file</span>
                                    Adjuntar imagen
                                    <input type="file" id="notaImagen" accept="image/*" multiple onchange="previsualizarImagenesNota()" style="display: none;">
                                </label>
                                <span id="archivosSeleccionados">Ning煤n archivo seleccionado</span>
                            </div>

                            <div id="imagenesPreview" class="imagenes-preview"></div>

                            <div class="nota-actions">
                                <button type="button" class="btn-secondary" onclick="cancelarNota()">Cancelar</button>
                                <button type="button" class="btn-primary" onclick="enviarNota()">
                                    <span class="material-symbols-rounded">send</span>
                                    Enviar nota
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BOTONES DE ACCIN -->
            <div class="form-actions">
                <button type="button" class="btn-cancel" onclick="cancelarFormulario()">
                    <span class="material-symbols-rounded">close</span>
                    Cancelar
                </button>
                <button type="button" class="btn-draft" onclick="guardarBorrador()" id="btnBorrador">
                    <span class="material-symbols-rounded">save</span>
                    Guardar Borrador
                </button>
                <button type="button" class="btn-next" onclick="siguientePestana()" id="btnSiguiente">
                    <span class="material-symbols-rounded">arrow_forward</span>
                    Siguiente
                </button>
                <button type="submit" class="btn-submit">
                    <span class="material-symbols-rounded">check_circle</span>
                    Guardar Cliente
                </button>
            </div>
        </form>
    </div>
                <!-- ============================================
                MODAL PARA DEPENDIENTES
                AGREGAR ANTES DE </body>
                ============================================ -->
            <div id="modalDependiente" class="modal">
                <div class="modal-overlay"></div>
                <div class="modal-container">
                    <div class="modal-header">
                        <h3 id="modalDependienteTitulo">Agregar Dependiente</h3>
                        <button type="button" class="btn-close-modal" onclick="cerrarModalDependiente()">
                            <span class="material-symbols-rounded">close</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="formDependiente">
                            <input type="hidden" id="modal_dep_id" value="">
                            <input type="hidden" id="modal_dep_count" value="">
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Nombres <span class="required">*</span></label>
                                    <input type="text" id="modal_dep_nombres" required>
                                </div>
                                <div class="form-group">
                                    <label>Apellidos <span class="required">*</span></label>
                                    <input type="text" id="modal_dep_apellidos" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Fecha de Nacimiento <span class="required">*</span></label>
                                    <input type="date" id="modal_dep_fecha_nacimiento" required>
                                </div>
                                <div class="form-group">
                                    <label>Sexo <span class="required">*</span></label>
                                    <select id="modal_dep_sexo" required>
                                        <option value="">Seleccionar...</option>
                                        <option value="masculino">Masculino</option>
                                        <option value="femenino">Femenino</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>SSN</label>
                                    <input type="text" id="modal_dep_ssn" placeholder="###-##-####" maxlength="11">
                                </div>
                                <div class="form-group">
                                    <label>Estado Migratorio</label>
                                    <select id="modal_dep_estado_migratorio">
                                        <option value="">Seleccionar...</option>
                                        <option value="Ciudadano">Ciudadano</option>
                                        <option value="Residente">Residente</option>
                                        <option value="Indocumentado">Indocumentado</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Relaci贸n</label>
                                    <select id="modal_dep_relacion">
                                        <option value="">Seleccionar...</option>
                                        <option value="Hijo/a">Hijo/a</option>
                                        <option value="Esposo/a">Esposo/a</option>
                                        <option value="Padre/Madre">Padre/Madre</option>
                                        <option value="Otro">Otro</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Aplica</label>
                                    <select id="modal_dep_aplica">
                                        <option value="">Seleccionar...</option>
                                        <option value="S铆">S铆</option>
                                        <option value="No">No</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn-secondary" onclick="cerrarModalDependiente()">
                            Cancelar
                        </button>
                        <button type="button" class="btn-primary" onclick="guardarDependienteModal()">
                            <span class="material-symbols-rounded">check</span>
                            Guardar
                        </button>
                    </div>
                </div>
            </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../js/supabase_config.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/cliente_editar.js"></script>
</body>
</html>